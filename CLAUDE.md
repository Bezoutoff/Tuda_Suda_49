# CLAUDE.md - Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ° Tuda Suda 49

## ĞĞ±Ğ·Ğ¾Ñ€ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

**Tuda Suda 49** â€” Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ±Ğ¾Ñ‚ Ğ´Ğ»Ñ Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²Ğ»Ğ¸ Ğ½Ğ° Polymarket. Ğ‘Ğ¾Ñ‚ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ¾ÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ñ‹Ñ… BTC updown 15-Ğ¼Ğ¸Ğ½ÑƒÑ‚Ğ½Ñ‹Ñ… Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ¾Ğ² Ğ¸ Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ¾ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰Ğ°ĞµÑ‚ Ğ¾Ñ€Ğ´ĞµÑ€Ğ° Ğ½Ğ° Ğ¿Ğ¾ĞºÑƒĞ¿ĞºÑƒ Ğ¿Ğ¾ 49 Ñ†ĞµĞ½Ñ‚Ğ¾Ğ² Ğ½Ğ° Ğ¾Ğ±Ğ° Ğ¸ÑÑ…Ğ¾Ğ´Ğ° (YES Ğ¸ NO).

### ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ
"Ğ¢ÑƒĞ´Ğ°-Ğ¡ÑĞ´Ğ° 49" â€” Ğ¾Ñ‚Ñ€Ğ°Ğ¶Ğ°ĞµÑ‚ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ: ÑÑ‚Ğ°Ğ²Ğ¸Ğ¼ Ğ¸ Ñ‚ÑƒĞ´Ğ° (YES), Ğ¸ ÑÑĞ´Ğ° (NO) Ğ¿Ğ¾ 49 Ñ†ĞµĞ½Ñ‚Ğ¾Ğ².

### Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ
BTC updown Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ñ‹ â€” ÑÑ‚Ğ¾ ĞºÑ€Ğ°Ñ‚ĞºĞ¾ÑÑ€Ğ¾Ñ‡Ğ½Ñ‹Ğµ (15 Ğ¼Ğ¸Ğ½ÑƒÑ‚) Ğ±Ğ¸Ğ½Ğ°Ñ€Ğ½Ñ‹Ğµ Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ñ‹ Ğ½Ğ° Ğ´Ğ²Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ Ñ†ĞµĞ½Ñ‹ Bitcoin. Ğ¡Ñ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ Ğ·Ğ°ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ÑÑ Ğ² Ñ‚Ğ¾Ğ¼, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¼ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸ Ğ½Ğ° Ğ¾Ğ±Ğ¾Ğ¸Ñ… Ğ¸ÑÑ…Ğ¾Ğ´Ğ°Ñ… Ğ¿Ğ¾ Ğ²Ñ‹Ğ³Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ñ†ĞµĞ½Ğµ 49Â¢. Ğ•ÑĞ»Ğ¸ Ğ¾Ñ€Ğ´ĞµÑ€ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑÑ Ğ¿Ğ¾ 49Â¢, Ğ° Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ ~50%, Ñ‚Ğ¾ ĞµÑÑ‚ÑŒ Ğ½ĞµĞ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğµ Ğ¿Ñ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¾.

## ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Tuda Suda 49 Bot                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ WebSocket       â”‚    â”‚ Trading         â”‚                â”‚
â”‚  â”‚ Client (RTDS)   â”‚â”€â”€â”€â–¶â”‚ Service         â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚          â”‚                      â”‚                          â”‚
â”‚          â”‚                      â”‚                          â”‚
â”‚          â–¼                      â–¼                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ Market Filter   â”‚    â”‚ CLOB Client     â”‚                â”‚
â”‚  â”‚ (btc-updown-15m)â”‚    â”‚ (Order API)     â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹

1. **WebSocket Client** (`@polymarket/real-time-data-client`)
   - ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ÑÑ Ğº Polymarket RTDS (Real-Time Data Service)
   - ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ½Ğ° topic `clob_market`, type `market_created`
   - ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğ¸ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ¾Ğ² Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸

2. **Market Filter**
   - Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ÑƒĞµÑ‚ Ğ²Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ñ‹ Ğ¿Ğ¾ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñƒ `btc-updown-15m`
   - Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ timestamp Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ² Ğ¸Ğ· slug (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: `btc-updown-15m-1764054900`)
   - ĞŸÑ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ´ÑƒĞ±Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸

3. **Trading Service** (`@polymarket/clob-client`)
   - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ğ½Ñ‹Ğµ Ğ¾Ñ€Ğ´ĞµÑ€Ğ° Ğ½Ğ° Ğ±Ğ¸Ñ€Ğ¶Ñƒ
   - ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ GTD (Good-Til-Date) Ğ¾Ñ€Ğ´ĞµÑ€Ğ° Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ¾Ñ‚Ğ¼ĞµĞ½Ğ¾Ğ¹
   - Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ POLY_PROXY signature type Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸

## Ğ¤Ğ°Ğ¹Ğ»Ğ¾Ğ²Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°

```
Tuda_Suda_49/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ bot.ts              # Entry point, Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ±Ğ¾Ñ‚Ğ°
â”‚   â”œâ”€â”€ config.ts           # ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ±Ğ¾Ñ‚Ğ° Ğ¸ trading
â”‚   â”œâ”€â”€ trading-service.ts  # Ğ¡ĞµÑ€Ğ²Ğ¸Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ² (ÑƒĞ¿Ñ€Ğ¾Ñ‰Ñ‘Ğ½Ğ½Ñ‹Ğ¹)
â”‚   â””â”€â”€ types.ts            # TypeScript Ñ‚Ğ¸Ğ¿Ñ‹
â”œâ”€â”€ package.json            # Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¸ ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹
â”œâ”€â”€ tsconfig.json           # ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ TypeScript
â”œâ”€â”€ .env                    # Ğ¡ĞµĞºÑ€ĞµÑ‚Ñ‹ (ĞĞ• Ğ² git!)
â”œâ”€â”€ .env.example            # ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md               # Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹
â””â”€â”€ CLAUDE.md               # Ğ­Ñ‚Ğ¾Ñ‚ Ñ„Ğ°Ğ¹Ğ» (Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Claude)
```

## ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹

### src/bot.ts
ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ñ„Ğ°Ğ¹Ğ» Ğ±Ğ¾Ñ‚Ğ°. Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚:
- `main()` â€” Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞº
- `handleMarketCreated()` â€” Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ°
- `placeAutoOrders()` â€” Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ² YES Ğ¸ NO
- `fetchTokenIdsFromGamma()` â€” fallback Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ñ token IDs

### src/config.ts
ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ:
- `BOT_CONFIG` â€” Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ±Ğ¾Ñ‚Ğ° (Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½ Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ°, Ñ†ĞµĞ½Ğ°, Ñ€Ğ°Ğ·Ğ¼ĞµÑ€)
- `tradingConfig` â€” Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ trading service Ğ¸Ğ· .env
- Ğ’ÑĞ¿Ğ¾Ğ¼Ğ¾Ğ³Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸: `getOrderSize()`, `extractStartTimestamp()`, `isBtcUpdownMarket()`

### src/trading-service.ts
Ğ£Ğ¿Ñ€Ğ¾Ñ‰Ñ‘Ğ½Ğ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ trading service Ğ¸Ğ· live-trade-PM:
- `createLimitOrder()` â€” ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ¾Ñ€Ğ´ĞµÑ€Ğ°
- `cancelOrder()` â€” Ğ¾Ñ‚Ğ¼ĞµĞ½Ğ° Ğ¾Ñ€Ğ´ĞµÑ€Ğ°
- ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° GTC Ğ¸ GTD Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ²

### src/types.ts
TypeScript Ñ‚Ğ¸Ğ¿Ñ‹:
- `TradingConfig` â€” ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ trading service
- `CreateOrderRequest` â€” Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ğ¾Ñ€Ğ´ĞµÑ€Ğ°
- `Order` â€” ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¾Ñ€Ğ´ĞµÑ€Ğ°
- `OrderUpdate` â€” Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°

## ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ (.env)

```env
# ĞŸÑ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡ ĞºĞ¾ÑˆĞµĞ»ÑŒĞºĞ° (64 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ° Ğ‘Ğ•Ğ— 0x)
PK=your_private_key_here

# API credentials Ğ´Ğ»Ñ Polymarket CLOB
CLOB_API_KEY=your_api_key
CLOB_SECRET=your_secret
CLOB_PASS_PHRASE=your_passphrase

# ĞĞ´Ñ€ĞµÑ funder (Ğ´Ğ»Ñ POLY_PROXY, Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)
FUNDER=0x...

# Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¾Ñ€Ğ´ĞµÑ€Ğ° Ğ² USDC
BOT_ORDER_SIZE=10
```

## Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹

### 1. Ğ—Ğ°Ğ¿ÑƒÑĞº
```
npm start
```
- Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ .env
- Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ TradingService
- ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ÑÑ Ğº Polymarket RTDS
- ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ½Ğ° `market_created`

### 2. ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ°
ĞšĞ¾Ğ³Ğ´Ğ° Polymarket ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ¼Ğ°Ñ€ĞºĞµÑ‚, RTDS Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ:
```json
{
  "type": "market_created",
  "slug": "btc-updown-15m-1764054900",
  "tokens": [
    { "token_id": "123...", "outcome": "Up" },
    { "token_id": "456...", "outcome": "Down" }
  ]
}
```

### 3. Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ
Ğ‘Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚:
- Ğ¡Ğ¾Ğ´ĞµÑ€Ğ¶Ğ¸Ñ‚ Ğ»Ğ¸ slug Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½ `btc-updown-15m`
- ĞĞµ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ»ÑÑ Ğ»Ğ¸ ÑÑ‚Ğ¾Ñ‚ Ğ¼Ğ°Ñ€ĞºĞµÑ‚ Ñ€Ğ°Ğ½ĞµĞµ

### 4. Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
- Timestamp Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ°: `1764054900` Ğ¸Ğ· slug
- Token IDs Ğ´Ğ»Ñ YES Ğ¸ NO Ğ¸Ğ· ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ğ¸Ğ»Ğ¸ Gamma API

### 5. Ğ Ğ°Ğ·Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ²
Ğ”Ğ²Ğ° GTD Ğ¾Ñ€Ğ´ĞµÑ€Ğ°:
- **YES** @ 0.49 (49 Ñ†ĞµĞ½Ñ‚Ğ¾Ğ²)
- **NO** @ 0.49 (49 Ñ†ĞµĞ½Ñ‚Ğ¾Ğ²)

GTD expiration = timestamp Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ² - 60 ÑĞµĞºÑƒĞ½Ğ´ (Ğ±ÑƒÑ„ĞµÑ€)

## API Ğ¸ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸

### Polymarket APIs
- **RTDS WebSocket**: `wss://...` â€” real-time ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ
- **CLOB REST API**: `https://clob.polymarket.com` â€” ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ²
- **Gamma API**: `https://gamma-api.polymarket.com` â€” Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ°Ñ…

### npm Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
```json
{
  "@polymarket/clob-client": "^4.22.8",
  "@polymarket/real-time-data-client": "^1.4.0",
  "dotenv": "^17.2.3",
  "ethers": "^5.8.0"
}
```

## Ğ¡Ğ²ÑĞ·ÑŒ Ñ live-trade-PM

Ğ­Ñ‚Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ğ±Ñ‹Ğ» Ğ²Ñ‹Ğ´ĞµĞ»ĞµĞ½ Ğ¸Ğ· `live-trade-PM` (Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²Ñ‹Ğ¹ Ñ‚ĞµÑ€Ğ¼Ğ¸Ğ½Ğ°Ğ»). ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ¸Ñ:

| ĞÑĞ¿ĞµĞºÑ‚ | live-trade-PM | Tuda_Suda_49 |
|--------|---------------|--------------|
| ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ | Ğ ÑƒÑ‡Ğ½Ğ°Ñ Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²Ğ»Ñ Ñ UI | ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ±Ğ¾Ñ‚ |
| UI | Electron + HTML | ĞĞµÑ‚ (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞºĞ¾Ğ½ÑĞ¾Ğ»ÑŒ) |
| ĞŸĞ°Ñ€ÑĞµÑ€Ñ‹ | Bwin, Pinnacle, Polymarket | Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Polymarket |
| Trading Service | ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ | Ğ£Ğ¿Ñ€Ğ¾Ñ‰Ñ‘Ğ½Ğ½Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ |
| Ğ Ğ°Ğ·Ğ¼ĞµÑ€ | ~50+ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² | 4 Ñ„Ğ°Ğ¹Ğ»Ğ° Ğ² src/ |

## ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹

```bash
# Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ±Ğ¾Ñ‚Ğ°
npm start

# Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ² dev Ñ€ĞµĞ¶Ğ¸Ğ¼Ğµ (Ñ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞºĞ¾Ğ¼ Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸ÑÑ…)
npm run dev

# ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ TypeScript
npm run build
```

## Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ğµ ÑƒĞ»ÑƒÑ‡ÑˆĞµĞ½Ğ¸Ñ

1. **ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ** â€” Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ fills Ñ‡ĞµÑ€ĞµĞ· RTDS `clob_user` topic
2. **Ğ”Ğ¸Ğ½Ğ°Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ñ†ĞµĞ½Ğ°** â€” Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· order book Ğ¿ĞµÑ€ĞµĞ´ Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰ĞµĞ½Ğ¸ĞµĞ¼
3. **ĞœĞ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğµ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹** â€” Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ´Ñ€ÑƒĞ³Ğ¸Ñ… updown Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ¾Ğ² (ETH, SOL)
4. **Telegram ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ** â€” Ğ¾Ğ¿Ğ¾Ğ²ĞµÑ‰ĞµĞ½Ğ¸Ñ Ğ¾ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ°Ñ… Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğ¸
5. **Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ² Ñ„Ğ°Ğ¹Ğ»** â€” ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¸ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
6. **Graceful shutdown** â€” ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞµ

## Troubleshooting

### Auto-Sell Bot: "Cannot use import statement outside a module"

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Ğ‘Ğ¾Ñ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ (`npx ts-node src/auto-sell-bot.ts`), Ğ½Ğ¾ Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚ Ğ² PM2.

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** ĞÑ‚Ğ½Ğ¾ÑĞ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ÑŒ Ğº ts-node Ğ² `ecosystem.docker.config.js`

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```bash
# Ğ’ Docker ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğµ
pm2 delete auto-sell-bot
pm2 start /app/node_modules/.bin/ts-node \
  --name auto-sell-bot \
  -- /app/src/auto-sell-bot.ts
```

**ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸:**
```bash
grep "interpreter" /app/ecosystem.docker.config.js | grep auto-sell
# Ğ”Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ±Ñ‹Ñ‚ÑŒ: interpreter: '/app/node_modules/.bin/ts-node',
```

### PM2 Ğ»Ğ¾Ğ³Ğ¸ Ğ¿ÑƒÑÑ‚Ñ‹Ğµ (auto-sell-bot, updown-bot-49)

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** `pm2 logs bot-name` Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿ÑƒÑÑ‚Ğ¾Ñ‚Ñƒ

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** Ğ§Ğ¸Ñ‚Ğ°Ñ‚ÑŒ combined.log Ğ½Ğ°Ğ¿Ñ€ÑĞ¼ÑƒÑ:
```bash
tail -f /app/logs/auto-sell-bot-combined.log
tail -f /app/logs/updown-bot-49-combined.log
```

### Ğ¡ĞµÑ‚ĞµĞ²Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ (EPIPE, EAI_AGAIN, TLS disconnect)

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** ĞœĞ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²Ğ¾ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ¿Ñ€Ğ¸ spam Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°Ñ…:
```
[CLOB Client] request error {"error":"write EPIPE"}
[CLOB Client] request error {"error":"getaddrinfo EAI_AGAIN"}
```

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** Ğ¡Ğ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ¸Ğ½Ñ‚ĞµĞ½ÑĞ¸Ğ²Ğ½Ñ‹Ğ¹ spam (5ms = 1600 req/sec)

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ´ (ÑƒĞ¶Ğµ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾ Ğ² Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ¹ Ğ²ĞµÑ€ÑĞ¸Ğ¸):
- STREAM_INTERVAL_MS: 5ms â†’ 20ms
- POLL_INTERVAL_MS: 250ms â†’ 350ms

### ĞÑˆĞ¸Ğ±ĞºĞ° "API credentials required"
ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ñ‡Ñ‚Ğ¾ Ğ² .env Ğ·Ğ°Ğ´Ğ°Ğ½Ñ‹ CLOB_API_KEY, CLOB_SECRET, CLOB_PASS_PHRASE

### ĞÑ€Ğ´ĞµÑ€Ğ° Ğ½Ğµ ÑĞ¾Ğ·Ğ´Ğ°ÑÑ‚ÑÑ
1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ USDC Ğ½Ğ° Polymarket
2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ñ‡Ñ‚Ğ¾ funder address ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹
3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ»Ğ¾Ğ³Ğ¸ Ğ½Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ¾Ñ‚ CLOB API

### Ğ‘Ğ¾Ñ‚ Ğ½Ğµ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ñ‹
1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑŒÑ‚Ğµ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº RTDS (Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ±Ñ‹Ñ‚ÑŒ Ğ»Ğ¾Ğ³ "Connected")
2. Ğ£Ğ±ĞµĞ´Ğ¸Ñ‚ĞµÑÑŒ Ñ‡Ñ‚Ğ¾ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ° ("Subscribed to market_created")
3. BTC updown Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°ÑÑ‚ÑÑ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 15 Ğ¼Ğ¸Ğ½ÑƒÑ‚

## Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Latency

### src/test-latency.ts

Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ´Ğ»Ñ Ğ¸Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ñ latency HTTP POST Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğº Polymarket CLOB API.

**Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹:**
1. Polling Gamma API Ğ´Ğ¾ Ğ¿Ğ¾ÑĞ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ°
2. Ğ–Ğ´Ñ‘Ñ‚ DELAY_BEFORE_SPAM_MS (19 ÑĞµĞº)
3. Pre-sign 1 Ğ¾Ñ€Ğ´ĞµÑ€ (UP @ 0.45, expiration = 1 ÑĞµĞº Ğ´Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚Ğ°)
4. Spam postSignedOrder() Ñ 20 Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°Ğ¼Ğ¸
5. Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµÑ‚ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ² CSV Ñ„Ğ°Ğ¹Ğ»
6. Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ñ‚ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ: min, max, avg, median

**Ğ—Ğ°Ğ¿ÑƒÑĞº:**
```bash
npm run test-latency btc-updown-15m-1764930600
```

**CSV Ñ„Ğ°Ğ¹Ğ»:** `latency.csv`
```csv
timestamp,slug,side,price,latency_ms,success,error
```

**Ğ¢Ğ¸Ğ¿Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ latency:**
- Ğ¡Ğ¨Ğ (Ğ±Ğ»Ğ¸Ğ·ĞºĞ¾ Ğº ÑĞµÑ€Ğ²ĞµÑ€Ğ°Ğ¼): ~250-300ms
- Ğ•Ğ²Ñ€Ğ¾Ğ¿Ğ°: ~400-500ms
- ĞĞ·Ğ¸Ñ/Ğ´Ğ°Ğ»ĞµĞºĞ¾: ~600-800ms

**Ğ’Ğ»Ğ¸ÑĞ½Ğ¸Ğµ Ğ½Ğ° Ğ±Ğ¾Ñ‚Ğ°:**
- Latency Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ ÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº Ğ±Ğ¾Ñ‚ ÑƒÑĞ¿ĞµĞµÑ‚ ÑĞ´ĞµĞ»Ğ°Ñ‚ÑŒ
- ĞŸÑ€Ğ¸ 285ms Ğ·Ğ° 6 ÑĞµĞº = ~420 Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº
- ĞŸÑ€Ğ¸ 600ms Ğ·Ğ° 6 ÑĞµĞº = ~200 Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚Ğ¾Ğº (Ğ² 2 Ñ€Ğ°Ğ·Ğ° Ğ¼ĞµĞ½ÑŒÑˆĞµ!)

### ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ latency

```
HTTP POST /order:
â”œâ”€ DNS Ñ€ĞµĞ·Ğ¾Ğ»Ğ²:           ~1ms   (ĞºÑÑˆĞ¸Ñ€ÑƒĞµÑ‚ÑÑ)
â”œâ”€ TCP/TLS handshake:    ~10ms  (keep-alive)
â”œâ”€ Ğ¡Ğ•Ğ Ğ’Ğ•Ğ  ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ:   ~250ms   â† Ğ³Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ bottleneck
â”‚   â”œâ”€ Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸
â”‚   â”œâ”€ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ±Ğ°Ğ»Ğ°Ğ½ÑĞ°
â”‚   â”œâ”€ Matching engine
â”‚   â””â”€ Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ Ğ² Ğ‘Ğ”
â””â”€ ĞÑ‚Ğ²ĞµÑ‚ ÑĞµÑ€Ğ²ĞµÑ€Ğ°:       ~20ms
```

## C++ Latency Test

### Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ: âœ… Raw HTTP Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚

C++ Ğ²ĞµÑ€ÑĞ¸Ñ latency Ñ‚ĞµÑÑ‚Ğ° Ğ´Ğ»Ñ ÑÑ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ñ Ñ TypeScript.
Ğ¦ĞµĞ»ÑŒ: Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ, Ğ´Ğ°ÑÑ‚ Ğ»Ğ¸ C++ Ğ½Ğ° libcurl Ğ²Ñ‹Ğ¸Ğ³Ñ€Ñ‹Ñˆ Ğ² latency.

### Ğ¤Ğ°Ğ¹Ğ»Ñ‹
- `src/cpp/test-latency.cpp` â€” C++ HTTP ÑĞ¿Ğ°Ğ¼ Ñ libcurl + OpenSSL HMAC
- `src/test-latency-cpp.ts` â€” Node.js Ğ¾Ğ±Ñ‘Ñ€Ñ‚ĞºĞ° (polling + pre-sign)
- `build-cpp.sh` â€” ÑĞºÑ€Ğ¸Ğ¿Ñ‚ ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ubuntu

### Ğ—Ğ°Ğ¿ÑƒÑĞº
```bash
npm run build:cpp  # ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ C++
npm run test-latency-cpp btc-updown-15m-TIMESTAMP
```

### Ğ ĞµÑˆÑ‘Ğ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹

#### 1. 401 Unauthorized
- **POLY_ADDRESS**: ĞÑƒĞ¶ĞµĞ½ wallet address, Ğ½Ğµ funder address
- **Header names**: `POLY_ADDRESS` (underscore), Ğ½Ğµ `POLY-ADDRESS` (hyphen)
- **Signature**: URL-safe base64 (`+`â†’`-`, `/`â†’`_`)

#### 2. 400 "Invalid order payload"
SDK ĞºĞ¾Ğ½Ğ²ĞµÑ€Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ñ‚Ğ¸Ğ¿Ñ‹ Ğ² `orderToJson()`:
- `side: 0` â†’ `side: "BUY"` (ÑÑ‚Ñ€Ğ¾ĞºĞ°, Ğ½Ğµ Ñ‡Ğ¸ÑĞ»Ğ¾!)
- `orderType: 1` â†’ `orderType: "GTD"` (ÑÑ‚Ñ€Ğ¾ĞºĞ°, Ğ½Ğµ Ñ‡Ğ¸ÑĞ»Ğ¾!)

**Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ:**
```typescript
const transformedOrder = {
  ...signedOrder,
  salt: parseInt(signedOrder.salt, 10),
  side: signedOrder.side === 0 ? 'BUY' : 'SELL',  // KEY FIX
};

const orderBody = JSON.stringify([{
  deferExec: false,
  order: transformedOrder,
  owner: tradingConfig.apiKey,
  orderType: 'GTD',  // String, not number!
}]);
```

### ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹
```bash
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹ (Ubuntu)
sudo apt-get install -y build-essential libcurl4-openssl-dev libssl-dev

# ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ
npm run build:cpp

# Ğ—Ğ°Ğ¿ÑƒÑĞº
npm run test-latency-cpp btc-updown-15m-<TIMESTAMP>
```

## Ğ’Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Latency (Python)

### Ğ¤Ğ°Ğ¹Ğ»: `scripts/plot_latency.py`

Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ´Ğ»Ñ Ğ¿Ğ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ¸Ñ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¾Ğ² latency Ğ½Ğ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ `latency.csv`.

**Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹:**
```bash
pip install pandas matplotlib
```

**Ğ—Ğ°Ğ¿ÑƒÑĞº:**
```bash
python scripts/plot_latency.py latency.csv
```

**Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸:**
- Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ CSV Ñ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°Ğ¼Ğ¸ latency Ñ‚ĞµÑÑ‚Ğ¾Ğ²
- Ğ¡Ñ‚Ñ€Ğ¾Ğ¸Ñ‚ Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº latency Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ñ Ñ‚Ğ¾Ñ‡Ğ½Ñ‹Ğ¼Ğ¸ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ÑĞ¼Ğ¸ (Ğ¼Ñ) Ğ½Ğ°Ğ´ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ¹ Ñ‚Ğ¾Ñ‡ĞºĞ¾Ğ¹
- ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ²Ñ€ĞµĞ¼Ñ Ğ² Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğµ HH:MM:SS.mmm Ğ½Ğ° Ğ¾ÑĞ¸ X
- Ğ¡Ñ‚Ñ€Ğ¾Ğ¸Ñ‚ Ğ³Ğ¸ÑÑ‚Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ñƒ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ latency
- Ğ’Ñ‹Ğ²Ğ¾Ğ´Ğ¸Ñ‚ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ: min, max, mean, median, std, P95, P99
- Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ PNG Ñ„Ğ°Ğ¹Ğ»
- Ğ¢Ñ‘Ğ¼Ğ½Ğ°Ñ Ñ‚ĞµĞ¼Ğ°

**Ğ’Ñ‹Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹:**
- `latency_plot.png` â€” Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ latency

## Redemption Bot - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ²Ñ‹ĞºÑƒĞ¿ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹

### ĞĞ±Ğ·Ğ¾Ñ€

**Redemption Bot** â€” Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Python Ğ±Ğ¾Ñ‚ Ğ´Ğ»Ñ Ğ²Ñ‹ĞºÑƒĞ¿Ğ° Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹ Ğ½Ğ° Polymarket. Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 60 Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ñ‡ĞµÑ€ĞµĞ· systemd timer Ğ¸ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ²Ñ‹ĞºÑƒĞ¿Ğ°ĞµÑ‚ (redeem) Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸ Ñ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ½Ñ‹Ñ… Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ¾Ğ².

### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Systemd Timer (ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 60 Ğ¼Ğ¸Ğ½ÑƒÑ‚)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Python Redemption Bot (main.py)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 1. config.py â†’ Load .env credentials              â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                  â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 2. polymarket_api.py â†’ GET /balances/{funder}     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                  â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 3. redemption_logic.py â†’ Group by condition_id    â”‚     â”‚
â”‚  â”‚    Calculate indexSets for each outcome           â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                  â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 4. relayer_client.py â†’ POST /redeem               â”‚     â”‚
â”‚  â”‚    Builder Relayer integration                    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                  â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ 5. telegram_notifier.py â†’ Send to Telegram        â”‚     â”‚
â”‚  â”‚    csv_logger.py â†’ Log to redemption.csv          â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ğ¤Ğ°Ğ¹Ğ»Ñ‹

```
scripts/
â”œâ”€â”€ redemption/
â”‚   â”œâ”€â”€ __init__.py              # Python package marker
â”‚   â”œâ”€â”€ main.py                  # Entry point (systemd Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ ÑÑ‚Ğ¾)
â”‚   â”œâ”€â”€ config.py                # Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° .env, Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ
â”‚   â”œâ”€â”€ polymarket_api.py        # GET /balances API client
â”‚   â”œâ”€â”€ redemption_logic.py      # Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ° Ğ¿Ğ¾ condition_id, indexSets
â”‚   â”œâ”€â”€ relayer_client.py        # Builder Relayer + HMAC auth
â”‚   â”œâ”€â”€ telegram_notifier.py     # Telegram ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ (HTTP)
â”‚   â”œâ”€â”€ csv_logger.py            # CSV Ğ»Ğ¾Ğ³Ğ¸
â”‚   â””â”€â”€ redeemed_tracker.py      # ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²Ñ‹ĞºÑƒĞ¿Ğ»ĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹
â””â”€â”€ requirements.txt             # Python Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸

systemd/
â”œâ”€â”€ redemption-bot.service       # Systemd service (oneshot)
â””â”€â”€ redemption-bot.timer         # Systemd timer (60 min)

logs/
â””â”€â”€ redemption.csv               # CSV Ğ»Ğ¾Ğ³ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ¾Ğ²
```

### Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹

1. **Systemd timer** Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ `main.py` ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 60 Ğ¼Ğ¸Ğ½ÑƒÑ‚
2. **API Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ**: GET `/balances/{funder_address}` â€” Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸
3. **Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ**: ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞº ÑƒĞ¶Ğµ Ğ²Ñ‹ĞºÑƒĞ¿Ğ»ĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹ Ñ‡ĞµÑ€ĞµĞ· RedeemedTracker
4. **Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°**: Ğ¿Ğ¾ `condition_id`, Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»ĞµĞ½Ğ¸Ğµ `indexSets` (2^outcome_index)
5. **Redemption**: POST `/redeem` Ñ‡ĞµÑ€ĞµĞ· Builder Relayer (Ğ³Ğ°Ğ· Ğ¿Ğ¾ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ relayer)
6. **Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ**: Telegram (Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾, Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ñ‹ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸, ÑƒÑĞ¿ĞµÑ…/Ğ¾ÑˆĞ¸Ğ±ĞºĞ°)
7. **Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ**: CSV Ñ„Ğ°Ğ¹Ğ» (timestamp, condition, amount, tx_hash, status)

### Redemption Tracker - ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞº Ğ²Ñ‹ĞºÑƒĞ¿Ğ»ĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Ğ‘Ğ¾Ñ‚ Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ğ» 60-70 Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹, Ğ½Ğ¾ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ 1-5 Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾ Ğ½ÑƒĞ¶Ğ´Ğ°Ğ»Ğ¸ÑÑŒ Ğ² Ğ²Ñ‹ĞºÑƒĞ¿Ğµ. ĞÑÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ ÑƒĞ¶Ğµ Ğ±Ñ‹Ğ»Ğ¸ Ğ²Ñ‹ĞºÑƒĞ¿Ğ»ĞµĞ½Ñ‹ Ñ€Ğ°Ğ½ĞµĞµ, Ñ‡Ñ‚Ğ¾ Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°Ğ»Ğ¾ ~60 Ğ»Ğ¸ÑˆĞ½Ğ¸Ñ… API Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº AlreadyClaimedException Ğ·Ğ° Ğ·Ğ°Ğ¿ÑƒÑĞº.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ (2025-12-18):**

ĞœĞ¾Ğ´ÑƒĞ»ÑŒ `redeemed_tracker.py` Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°ĞµÑ‚ ÑƒĞ¶Ğµ Ğ²Ñ‹ĞºÑƒĞ¿Ğ»ĞµĞ½Ğ½Ñ‹Ğµ condition_ids:

1. **ĞŸÑ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ**: Ğ§Ğ¸Ñ‚Ğ°ĞµÑ‚ `logs/redemption.csv` Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ Ğ²ÑĞµ condition_ids ÑĞ¾ status='success' Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ (Set)
2. **Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ**: ĞŸĞµÑ€ĞµĞ´ redemption Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ condition_id Ñ‡ĞµÑ€ĞµĞ· O(1) lookup
3. **ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ**: ĞŸĞ¾ÑĞ»Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾Ğ³Ğ¾ redemption Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ condition_id Ğ² ĞºÑÑˆ

**Ğ¤Ğ°Ğ¹Ğ»:** `scripts/redemption/redeemed_tracker.py`

**ĞšĞ»Ğ°ÑÑ RedeemedTracker:**
- `__init__(csv_path)` - Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ Ğ²Ñ‹ĞºÑƒĞ¿Ğ»ĞµĞ½Ğ½Ñ‹Ğµ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ Ğ¸Ğ· CSV Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ
- `_load_from_csv()` - ĞŸĞ°Ñ€ÑĞ¸Ñ‚ CSV, Ğ¸Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ condition_ids ÑĞ¾ status='success'
- `is_already_redeemed(condition_id)` - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ²Ñ‹ĞºÑƒĞ¿Ğ»ĞµĞ½Ğ° Ğ»Ğ¸ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ñ (O(1))
- `mark_as_redeemed(condition_id)` - ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ ĞºÑÑˆ Ğ² Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ğ¿Ğ¾ÑĞ»Ğµ ÑƒÑĞ¿ĞµÑ…Ğ°
- `get_redeemed_count()` - Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ñ… ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğ¹

**ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº:**
- ĞÑ‚ÑÑƒÑ‚ÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ CSV (Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº): ĞĞ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ Ñ Ğ¿ÑƒÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²Ğ°
- ĞŸĞ¾Ğ²Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ½Ñ‹Ğµ ÑÑ‚Ñ€Ğ¾ĞºĞ¸: ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ ÑÑ‚Ñ€Ğ¾ĞºÑƒ, Ğ»Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµÑ‚ warning, Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°ĞµÑ‚
- ĞÑˆĞ¸Ğ±ĞºĞ¸ Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ°: Ğ›Ğ¾Ğ²Ğ¸Ñ‚, Ğ»Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµÑ‚, Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ Ñ Ğ¿ÑƒÑÑ‚Ğ¾Ğ³Ğ¾ Ğ¼Ğ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²Ğ°

**Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ² main.py:**
```python
# Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ÑĞ»Ğµ CSVLogger
redeemed_tracker = RedeemedTracker(config.csv_log_path)
logger.info(f"Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ¾ {redeemed_tracker.get_redeemed_count()} Ñ€Ğ°Ğ½ĞµĞµ Ğ²Ñ‹ĞºÑƒĞ¿Ğ»ĞµĞ½Ğ½Ñ‹Ñ… ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğ¹")

# Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ÑĞ»Ğµ Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸
for group in redemption_groups:
    if redeemed_tracker.is_already_redeemed(group.condition_id):
        skipped_count += 1
        continue
    filtered_groups.append(group)

# ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ÑĞ»Ğµ ÑƒÑĞ¿ĞµÑ…Ğ°
success_count += 1
redeemed_tracker.mark_as_redeemed(group.condition_id)
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹:**

Ğ”Ğ¾:
```
Found 65 conditions, $968.50 USDC
Processing 65 redemptions...
â†’ 5 ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾, 60 Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº AlreadyClaimedException
```

ĞŸĞ¾ÑĞ»Ğµ:
```
Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ğ¾ 57 Ñ€Ğ°Ğ½ĞµĞµ Ğ²Ñ‹ĞºÑƒĞ¿Ğ»ĞµĞ½Ğ½Ñ‹Ñ… ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğ¹
Found 65 conditions, $968.50 USDC
Filtered: 8 Ğ´Ğ»Ñ Ğ²Ñ‹ĞºÑƒĞ¿Ğ°, 57 ÑƒĞ¶Ğµ Ğ²Ñ‹ĞºÑƒĞ¿Ğ»ĞµĞ½Ğ¾ ($920.00)
Processing 8 redemptions...
â†’ 5 ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾, 3 AlreadyClaimedException (Ğ¾Ñ‚ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… redemption)
```

**ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:**
- âœ… ĞĞ° ~90% Ğ¼ĞµĞ½ÑŒÑˆĞµ API Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğº relayer (Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ 57+ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹)
- âœ… Ğ­ĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ 30-60 ÑĞµĞºÑƒĞ½Ğ´ Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº
- âœ… Ğ§Ğ¸Ñ‰Ğµ Ğ»Ğ¾Ğ³Ğ¸ (Ğ½ĞµÑ‚ ÑĞ¿Ğ°Ğ¼Ğ° AlreadyClaimedException)
- âœ… ĞĞµÑ‚ Ğ´ÑƒĞ±Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² (Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ CSV)
- âœ… ĞĞ±Ñ€Ğ°Ñ‚Ğ½Ğ°Ñ ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ (Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¼ Ğ·Ğ°Ğ¿ÑƒÑĞºĞµ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ)

### Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°

**Ubuntu 23.04+ Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ virtual environment (PEP 668):**

```bash
# 1. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Python Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸

# Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ A: Virtual Environment (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)
python3 -m venv venv
source venv/bin/activate
pip install -r scripts/requirements.txt

# Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ B: System-wide (Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ, Ğ½Ğ¾ Ğ½Ğµ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)
pip3 install -r scripts/requirements.txt --break-system-packages

# 2. Ğ¢ĞµÑÑ‚ (manual run)
python3 scripts/redemption/main.py

# 3. ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ .env Ñ„Ğ°Ğ¹Ğ»
cp .env.example .env
nano .env
# Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ: PK, FUNDER, BUILDER_API_KEY, BUILDER_SECRET, BUILDER_PASSPHRASE

# 4. Ğ•ÑĞ»Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚Ğµ venv - Ğ¾Ñ‚Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ systemd service
nano systemd/redemption-bot.service
# Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ ExecStart Ğ½Ğ° Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ÑŒ Ğº venv/bin/python3:
# ExecStart=/root/Tuda_Suda_49/venv/bin/python3 /root/Tuda_Suda_49/scripts/redemption/main.py

# 5. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ systemd timer (Linux VPS)
sudo cp systemd/redemption-bot.* /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable redemption-bot.timer
sudo systemctl start redemption-bot.timer

# 6. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ
sudo systemctl status redemption-bot.timer
sudo journalctl -u redemption-bot.service -f
```

### ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

```bash
# Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ timer
sudo systemctl list-timers redemption-bot.timer

# Live logs (systemd journal)
sudo journalctl -u redemption-bot.service -f

# CSV Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹
tail -f logs/redemption.csv

# Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº (Ğ½Ğµ Ğ´Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ñ‚ÑŒÑÑ timer)
sudo systemctl start redemption-bot.service
```

### Telegram ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ

Ğ•ÑĞ»Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ñ‹ `TELEGRAM_BOT_TOKEN` Ğ¸ `TELEGRAM_ADMIN_ID`, Ğ±Ğ¾Ñ‚ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚:

- ğŸ” **Check start**: "Redemption Check Started" (Ğ²Ñ€ĞµĞ¼Ñ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°)
- ğŸ’° **Found positions**: "Found 3 conditions, $45.67 USDC to redeem"
- âœ… **Success**: "Redeemed $15.00 from condition abc123... (tx: 0xdef456...)"
- âŒ **Error**: "Failed to redeem condition xyz789...: error message"
- â„¹ï¸ **No positions**: "No positions to redeem"

### CSV Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚

`logs/redemption.csv`:

```csv
timestamp,condition_id,parent_collection_id,index_sets,amount_usdc,status,tx_hash,error
2025-12-14T10:00:15,0xabc123...,0x000...,1|2,15.500000,success,0xdef456...,
2025-12-14T10:00:18,0xghi789...,0x000...,1,8.250000,error,,Relayer timeout
```

### IndexSets Calculation

Binary markets (2 outcomes):
- Outcome 0 (YES) â†’ indexSet = 2^0 = 1 (binary: 01)
- Outcome 1 (NO) â†’ indexSet = 2^1 = 2 (binary: 10)

Multi-outcome markets:
- indexSet = 1 << outcome_index (bitshift)

### Builder Relayer Integration

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ñ‚Ğµ Ğ¶Ğµ credentials Ñ‡Ñ‚Ğ¾ CLOB API (`CLOB_API_KEY`, `CLOB_SECRET`, `CLOB_PASS_PHRASE`):

1. **HMAC-SHA256 signature**: `timestamp + method + path + body`
2. **Headers**:
   - `POLY_ADDRESS`: wallet address (ĞĞ• funder!)
   - `POLY_SIGNATURE`: URL-safe base64
   - `POLY_TIMESTAMP`: unix timestamp
   - `POLY_API_KEY`: API key
   - `POLY_PASSPHRASE`: passphrase

3. **Endpoint**: POST `/redeem`
   - `conditionId`: condition ID Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ°
   - `indexSets`: ÑĞ¿Ğ¸ÑĞ¾Ğº indexSets Ğ´Ğ»Ñ Ğ²Ñ‹ĞºÑƒĞ¿Ğ°
   - `parentCollectionId`: Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾ 0x000...

### ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ credentials Ğ¸Ğ· `.env`:
- `PK` â€” Ğ¿Ñ€Ğ¸Ğ²Ğ°Ñ‚Ğ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡ (Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸)
- `FUNDER` â€” funder address (Ğ´Ğ»Ñ API Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²)
- `CLOB_API_KEY`, `CLOB_SECRET`, `CLOB_PASS_PHRASE` â€” Builder Relayer auth
- `TELEGRAM_BOT_TOKEN`, `TELEGRAM_ADMIN_ID` â€” ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)

### Systemd Timer

**redemption-bot.timer**:
- `OnBootSec=5min` â€” Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº Ñ‡ĞµÑ€ĞµĞ· 5 Ğ¼Ğ¸Ğ½ Ğ¿Ğ¾ÑĞ»Ğµ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸
- `OnUnitActiveSec=60min` â€” Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ñ‹Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 60 Ğ¼Ğ¸Ğ½ÑƒÑ‚
- `Persistent=true` â€” Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑ‰ĞµĞ½Ğ½Ñ‹Ğµ runs (ĞµÑĞ»Ğ¸ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ±Ñ‹Ğ»Ğ° Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ğ°)
- `RandomizedDelaySec=5min` â€” ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ğ°Ñ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ´Ğ¾ 5 Ğ¼Ğ¸Ğ½ (Ğ¸Ğ·Ğ±ĞµĞ¶Ğ°Ñ‚ÑŒ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ñ€Ğ¾Ğ²Ğ½Ğ¾ Ğ² Ñ‡Ğ°Ñ)

**redemption-bot.service**:
- `Type=oneshot` â€” Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ Ğ¾Ğ´Ğ¸Ğ½ Ñ€Ğ°Ğ·, Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµÑ‚ÑÑ
- `Restart=on-failure` â€” restart ĞµÑĞ»Ğ¸ exit code != 0 (Ğ¿Ğ¾ÑĞ»Ğµ 5 Ğ¼Ğ¸Ğ½)
- `StandardOutput=journal` â€” Ğ»Ğ¾Ğ³Ğ¸ Ğ² systemd journalctl

### Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ°Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ Ğ² `REDEMPTION_README.md`:
- Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°
- ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ
- ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ troubleshooting
- Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ»Ğ°
- Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Telegram Ğ±Ğ¾Ñ‚Ğ¾Ğ¼

## Troubleshooting (Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ½Ñ‹Ğ¹)

### C++ Latency Test: latencyRecords.length = 0

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Ğ’ Ğ»Ğ¾Ğ³Ğ°Ñ… `[TRACK] latencyRecords.length = 0` Ğ´Ğ°Ğ¶Ğµ Ğ¿Ğ¾ÑĞ»Ğµ Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ° `trackLatency()`.

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ `shouldLog()` Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°Ğ»Ğ° `false` Ğ´Ğ»Ñ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ñ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸ĞµĞ¼ "the orderbook ... does not exist" â€” Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° `error?.includes('does not exist')` Ğ½Ğµ ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ğ»Ğ° Ğ¸Ğ·-Ğ·Ğ° Ğ´Ñ€ÑƒĞ³Ğ¾Ğ³Ğ¾ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ `shouldLog()` Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ²ÑĞµ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ¸:
```typescript
function shouldLog(success: boolean, error?: string): boolean {
  if (success) return true;
  if (error?.includes('does not exist')) return true;
  return true;  // Log all attempts
}
```

### C++ stdout Ğ½Ğµ Ğ´Ğ¾Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ´Ğ¾ Node.js

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** ATTEMPT: ÑÑ‚Ñ€Ğ¾ĞºĞ¸ Ğ¸Ğ· C++ Ğ½Ğµ Ğ¿Ğ¾ÑĞ²Ğ»ÑĞ»Ğ¸ÑÑŒ Ğ² Node.js.

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** C++ stdout Ğ±ÑƒÑ„ĞµÑ€Ğ¸Ğ·ÑƒĞµÑ‚ÑÑ, Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ½Ğµ ÑĞ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ÑÑ‚ÑÑ ÑÑ€Ğ°Ğ·Ñƒ.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ `std::cout.flush()` Ğ¿Ğ¾ÑĞ»Ğµ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ° Ğ² C++:
```cpp
std::cout << "ATTEMPT:" << attempts << ":" << latencyMs << ":true:" << orderId << std::endl;
std::cout.flush();
```

### ĞÑ€Ğ´ĞµÑ€ Ğ½Ğµ Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ĞµÑ‚ÑÑ Ğ½Ğ° Polymarket

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Ğ›Ğ¾Ğ³ Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ ÑƒÑĞ¿ĞµÑ… (status 200), Ğ½Ğ¾ Ğ¾Ñ€Ğ´ĞµÑ€ Ğ½Ğµ Ğ²Ğ¸Ğ´ĞµĞ½.

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** Expiration Ğ±Ñ‹Ğ» Ğ² Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ¾Ğ¼ Ğ¾Ñ‚Ğ½Ğ¾ÑĞ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¸. ĞÑ€Ğ´ĞµÑ€ Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ¾ Ğ¸ÑÑ‚ĞµĞºĞ°Ğ».

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ `expirationBuffer` Ğ¸Ğ· `ORDER_CONFIG` Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ·Ğ°Ñ…Ğ°Ñ€Ğ´ĞºĞ¾Ğ¶ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ:
```typescript
const expirationTimestamp = marketTimestamp - TEST_EXPIRATION_BUFFER;
```

### Status 200 Ğ½Ğ¾ orderID Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** HTTP 200 OK, Ğ½Ğ¾ Ğ² Ğ¾Ñ‚Ğ²ĞµÑ‚Ğµ `orderID: ""` Ğ¸ Ğ¾Ñ€Ğ´ĞµÑ€ Ğ½Ğµ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½.

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** ĞšĞ¾Ğ´ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞ» Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ `status === 200`, Ğ½Ğ¾ Ğ½Ğµ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞ» Ñ‡Ñ‚Ğ¾ `orderID` Ğ½Ğµ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹. Ğ¡ĞµÑ€Ğ²ĞµÑ€ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ 200 Ğ´Ğ°Ğ¶Ğµ ĞºĞ¾Ğ³Ğ´Ğ° orderbook Ğ½Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºÑƒ `orderID`:
```typescript
if (rawResp.status === 200) {
  const parsed = JSON.parse(rawResult);
  const orderId = parsed[0]?.orderID || '';
  if (orderId) {
    // Ğ£ÑĞ¿ĞµÑ… - Ğ¾Ñ€Ğ´ĞµÑ€ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½
  } else {
    // Orderbook Ğ½Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚
  }
}
```

### CSV: Ñ€Ğ°Ğ·Ğ½Ğ¾Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ĞºĞ¾Ğ»Ğ¾Ğ½Ğ¾Ğº

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** pandas Ğ½Ğµ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ CSV Ñ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¼ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾Ğ¼ ĞºĞ¾Ğ»Ğ¾Ğ½Ğ¾Ğº (ÑÑ‚Ğ°Ñ€Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ 12, Ğ½Ğ¾Ğ²Ñ‹Ğ¹ 19).

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** Ğ§Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸ ĞºĞ¾Ğ»Ğ¾Ğ½Ğ¾Ğº:
```python
df = pd.read_csv(csv_path, header=None, skiprows=1,
                 usecols=[0, 7, 8],
                 names=['server_time_ms', 'latency_ms', 'status'])
```

### Stream spam: Ğ½Ğµ Ğ²ÑĞµ Ğ¾Ñ€Ğ´ĞµÑ€Ğ° ÑÑ‚Ğ°Ğ²ÑÑ‚ÑÑ

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** ĞŸÑ€Ğ¸ stream ÑĞ¿Ğ°Ğ¼Ğµ ÑÑ‚Ğ°Ğ²ÑÑ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ 6-9 Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ² Ğ¸Ğ· 10, ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğµ Ğ¾Ñ€Ğ´ĞµÑ€Ğ° Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ°ÑÑ‚ÑÑ.

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** `sendRequest()` Ğ½Ğµ Ğ¶Ğ´Ñ‘Ñ‚ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° â€” Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ "Ğ² Ğ¿Ğ¾Ğ»Ñ‘Ñ‚Ğµ" ĞºĞ¾Ğ³Ğ´Ğ° Ñ†Ğ¸ĞºĞ» ÑƒĞ¶Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ°ĞµÑ‚ÑÑ. ĞĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚Ñ‹ Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´ÑÑ‚ Ğ¿Ğ¾ÑĞ»Ğµ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ° Ğ¸Ğ· Ñ†Ğ¸ĞºĞ»Ğ°.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑŒ Ğ²ÑĞµ Ğ¿Ñ€Ğ¾Ğ¼Ğ¸ÑÑ‹ Ğ¸ Ğ¶Ğ´Ğ°Ñ‚ÑŒ Ğ¸Ñ… Ğ² ĞºĞ¾Ğ½Ñ†Ğµ:
```typescript
const inFlightRequests: Promise<void>[] = [];

const sendRequest = (order) => {
  const promise = tradingService.postSignedOrder(...)
    .then(result => { order.placed = true; })
    .catch(() => {});
  inFlightRequests.push(promise);  // Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµĞ¼ Ğ¿Ñ€Ğ¾Ğ¼Ğ¸Ñ
};

// ĞŸĞ¾ÑĞ»Ğµ Ñ†Ğ¸ĞºĞ»Ğ° - Ğ¶Ğ´Ñ‘Ğ¼ Ğ²ÑĞµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
await Promise.all(inFlightRequests);
```

### Polymarket Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ +60 ÑĞµĞº Ğº expiration

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** ĞÑ€Ğ´ĞµÑ€ Ğ·Ğ°ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ·Ğ° 90 ÑĞµĞº Ğ´Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚Ğ° Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ¾Ğ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ñ‹Ñ… 30 ÑĞµĞº.

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** Polymarket Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµÑ‚ +60 ÑĞµĞºÑƒĞ½Ğ´ Ğº Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ expiration Ğ¿Ñ€Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğ¸ GTD Ğ¾Ñ€Ğ´ĞµÑ€Ğ°.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** Ğ’Ñ‹Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ 60 Ğ¸Ğ· Ğ¶ĞµĞ»Ğ°ĞµĞ¼Ğ¾Ğ³Ğ¾ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ expirationBuffer:
```typescript
// Ğ¥Ğ¾Ñ‚Ğ¸Ğ¼: 30 ÑĞµĞº Ğ´Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚Ğ°
// PM Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ +60, Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑÑ: 30+60 = 90 ÑĞµĞº Ğ´Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚Ğ°
// ĞŸĞ¾ÑÑ‚Ğ¾Ğ¼Ñƒ ÑÑ‚Ğ°Ğ²Ğ¸Ğ¼: 30-60 = -30
{ price: 0.45, size: 10, expirationBuffer: -30 },  // 30 ÑĞµĞº Ğ´Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚Ğ°
```

**Ğ¤Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ°:** `expirationBuffer = Ğ¶ĞµĞ»Ğ°ĞµĞ¼Ğ¾Ğµ_Ğ²Ñ€ĞµĞ¼Ñ_Ğ´Ğ¾_ÑÑ‚Ğ°Ñ€Ñ‚Ğ° - 60`

## Redemption Bot - Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ (2025-12-15)

### âœ… Ğ§Ñ‚Ğ¾ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚:
1. **API Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³**: ĞĞ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ redeemable Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸ (18 ÑˆÑ‚, $968 USDC)
   - Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ñ‹ Ğ½Ğ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾Ğ»ĞµĞ¹: `conditionId`, `asset`, `title` (camelCase)
   - ĞšĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ñ‹Ğ¹ Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³ `outcome` (ÑÑ‚Ñ€Ğ¾ĞºĞ¸ "Yes"/"No" Ğ¸ Ñ‡Ğ¸ÑĞ»Ğ°)
2. **SDK Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ**: py-builder-relayer-client ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½
3. **Calldata Ñ„Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ**: redeemPositions() calldata Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾
4. **SafeTransaction**: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ÑÑ Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ°Ğ¼Ğ¸
5. **Systemd timer**: Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½ (ÑƒĞ±Ñ€Ğ°Ğ½ Restart=on-failure loop)

### âŒ Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°: 401 Authorization Error

```
POST /submit HTTP/1.1" 401 34
RelayerApiException[status_code=401, error_message={'error': 'invalid authorization'}]
```

**Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ñ‹:**
1. CLOB credentials (API_KEY, SECRET, PASSPHRASE) Ğ½Ğµ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‚ Ğ´Ğ»Ñ Relayer API
2. ĞÑƒĞ¶Ğ½Ñ‹ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ Builder credentials Ğ´Ğ»Ñ relayer
3. Wallet Ğ½Ğµ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ğ² Builder Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğµ Polymarket
4. ĞĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑŒ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸

**Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ:**
- [ ] Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹ Ğ»Ğ¸ CLOB credentials Ğ´Ğ»Ñ relayer endpoint
- [ ] ĞÑƒĞ¶Ğ½Ğ° Ğ»Ğ¸ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ² Polymarket Builder Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğµ
- [ ] Ğ•ÑÑ‚ÑŒ Ğ»Ğ¸ Ğ¾Ñ‚Ğ´ĞµĞ»ÑŒĞ½Ñ‹Ğµ credentials Ğ´Ğ»Ñ relayer
- [ ] Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ½ÑƒĞ¶ĞµĞ½ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ (Ğ¿Ñ€ÑĞ¼Ğ°Ñ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ñ Ğ²Ğ¼ĞµÑÑ‚Ğ¾ relayer)

**Ğ¤Ğ°Ğ¹Ğ»Ñ‹ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸:**
- `scripts/redemption/relayer_client.py` - RelayClient Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
- `scripts/redemption/config.py` - Credentials Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°
- `.env` - CLOB_API_KEY, CLOB_SECRET, CLOB_PASS_PHRASE

**Ğ›Ğ¾Ğ³Ğ¸ Ñ DEBUG:**
```
[DEBUG] RelayClient: Created transaction request: {...}
[DEBUG] https://relayer-v2.polymarket.com:443 "POST /submit HTTP/1.1" 401 34
[ERROR] RelayerApiException[status_code=401, error_message={'error': 'invalid authorization'}]
```

**ĞĞ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´Ñ‹:**
1. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€ÑĞ¼Ñ‹Ğµ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸ (Ğ½ÑƒĞ¶ĞµĞ½ Ğ³Ğ°Ğ· MATIC)
2. ĞĞ°Ğ¹Ñ‚Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğµ Builder credentials
3. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¹ Ğ¼ĞµÑ‚Ğ¾Ğ´ redemption (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)

---

## Auto-Sell Bot - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ° Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹

### ĞĞ±Ğ·Ğ¾Ñ€

**Auto-Sell Bot** â€” Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ±Ğ¾Ñ‚ Ğ´Ğ»Ñ Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ½Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ¸ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹ Ğ½Ğ° Polymarket Ñ‡ĞµÑ€ĞµĞ· market orders. ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ¾ÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹ Ñ‡ĞµÑ€ĞµĞ· WebSocket User Channel Ğ¸ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ´Ğ°Ñ‘Ñ‚ Ğ¸Ñ… market order'Ğ¾Ğ¼ (FOK).

### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Auto-Sell Bot (src/auto-sell-bot.ts)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ 1. WebSocket User Channel â†’ clob_user         â”‚         â”‚
â”‚  â”‚    ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ½Ğ° Ğ’Ğ¡Ğ• ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ: type: '*'         â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                  â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ 2. handleTradeEvent()                         â”‚         â”‚
â”‚  â”‚    Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ:                                â”‚         â”‚
â”‚  â”‚    - side === 'BUY' (Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ»Ğ°ÑÑŒ)       â”‚         â”‚
â”‚  â”‚    - maker_address === funder (Ğ½Ğ°Ñˆ ĞºĞ¾ÑˆĞµĞ»ĞµĞº)   â”‚         â”‚
â”‚  â”‚    - Deduplication (Set<tradeId>)             â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                  â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ 3. sellPosition()                             â”‚         â”‚
â”‚  â”‚    Market order SELL:                         â”‚         â”‚
â”‚  â”‚    - OrderType: FOK (Fill-or-Kill)            â”‚         â”‚
â”‚  â”‚    - Fallback: FAK (Fill-and-Kill)            â”‚         â”‚
â”‚  â”‚    - Instant execution                        â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ğ¤Ğ°Ğ¹Ğ»Ñ‹

```
src/
â”œâ”€â”€ auto-sell-bot.ts             # Entry point (WebSocket + trading logic)
â”œâ”€â”€ trading-service.ts           # Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ createAndPostMarketOrder()
â”œâ”€â”€ types.ts                     # CreateMarketOrderRequest interface
â””â”€â”€ config.ts                    # AUTO_SELL_CONFIG

ecosystem.config.js              # PM2 ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ (local VPS)
ecosystem.docker.config.js       # PM2 ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ (Docker)
```

### Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹

1. **WebSocket Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ°**:
   - Topic: `clob_user`
   - Type: `*` (Ğ²ÑĞµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ: FILL, MATCH, PLACEMENT, etc.)
   - Auth: CLOB credentials (API_KEY, SECRET, PASSPHRASE)

2. **ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ¹ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸**:
   ```typescript
   if (side === 'BUY' &&
       maker_address === funder &&
       !processedTrades.has(tradeId)) {
     // ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ»Ğ°ÑÑŒ - Ğ¿Ñ€Ğ¾Ğ´Ğ°Ñ‚ÑŒ!
   }
   ```

3. **ĞŸÑ€Ğ¾Ğ´Ğ°Ğ¶Ğ° Ñ‡ĞµÑ€ĞµĞ· market order**:
   ```typescript
   await tradingService.createAndPostMarketOrder({
     tokenId: assetId,
     side: 'SELL',
     amount: size,  // ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ÑˆĞµÑ€ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ¸
     orderType: 'FOK'  // Fill-or-Kill (Ğ²ÑÑ‘ Ğ¸Ğ»Ğ¸ Ğ½Ğ¸Ñ‡ĞµĞ³Ğ¾)
   });
   ```

4. **Fallback Ğ¿Ñ€Ğ¸ Ğ½ĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğ¹ Ğ»Ğ¸ĞºĞ²Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚Ğ¸**:
   - Ğ•ÑĞ»Ğ¸ FOK Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½Ğ¸Ğ»ÑÑ â†’ retry Ñ FAK (Ñ‡Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ OK)

### Market Orders (FOK vs FAK)

| OrderType | ĞŸĞ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ | Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ |
|-----------|-----------|---------------|
| **FOK** (Fill-or-Kill) | Ğ›Ğ¸Ğ±Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ, Ğ»Ğ¸Ğ±Ğ¾ Ğ¾Ñ‚Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ | ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ Ğ´Ğ»Ñ instant sell |
| **FAK** (Fill-and-Kill) | Ğ§Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ, Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ğº Ğ¾Ñ‚Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ | Fallback Ğ¿Ñ€Ğ¸ Ğ½Ğ¸Ğ·ĞºĞ¾Ğ¹ Ğ»Ğ¸ĞºĞ²Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚Ğ¸ |

### Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞº

**Local VPS (Ğ±ĞµĞ· Docker):**
```bash
# Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‡ĞµÑ€ĞµĞ· npm
npm run auto-sell

# Ğ˜Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· PM2
pm2 start ecosystem.config.js --only auto-sell-bot
pm2 logs auto-sell-bot
```

**Docker:**
```bash
# ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ÑÑ‚ÑÑ Ğ‘Ğ•Ğ— Ğ°Ğ²Ñ‚Ğ¾ÑÑ‚Ğ°Ñ€Ñ‚Ğ° Ğ±Ğ¾Ñ‚Ğ¾Ğ² (docker-compose.override.yml)
docker compose up -d

# Ğ—Ğ°Ğ¹Ñ‚Ğ¸ Ğ² ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€
docker exec -it tuda-suda-trading bash

# Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ auto-sell-bot Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ
pm2 start ./node_modules/.bin/ts-node --name auto-sell-bot -- src/auto-sell-bot.ts
pm2 logs auto-sell-bot
```

### ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

**Ğ¤Ğ°Ğ¹Ğ»:** `src/config.ts`

```typescript
export const AUTO_SELL_CONFIG = {
  DEFAULT_ORDER_TYPE: 'FOK' as 'FOK' | 'FAK',
  FALLBACK_TO_FAK: true,
  LOG_PREFIX: '[AUTO-SELL]',
};
```

**Environment variables (.env):**
- `CLOB_API_KEY` - Polymarket CLOB API key
- `CLOB_SECRET` - Polymarket CLOB API secret
- `CLOB_PASS_PHRASE` - Polymarket CLOB API passphrase
- `FUNDER` - Funder address (Ğ´Ğ»Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ ÑĞ²Ğ¾Ğ¸Ñ… trades)

### Trading Service Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ

**Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ Ğ¼ĞµÑ‚Ğ¾Ğ´:** `createAndPostMarketOrder()`

```typescript
// src/trading-service.ts
async createAndPostMarketOrder(request: CreateMarketOrderRequest): Promise<Order> {
  const userMarketOrder = {
    tokenID: request.tokenId,
    amount: request.amount,  // Ğ”Ğ»Ñ SELL: ĞºĞ¾Ğ»-Ğ²Ğ¾ ÑˆĞµÑ€
    side: request.side === 'BUY' ? Side.BUY : Side.SELL,
  };

  const orderType = request.orderType === 'FAK' ? OrderType.FAK : OrderType.FOK;

  const orderResponse = await this.client.createAndPostMarketOrder(
    userMarketOrder,
    undefined,
    orderTypeEnum,
    false
  );

  return { orderId: orderResponse.orderID, ... };
}
```

### Troubleshooting

#### ĞŸĞ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ½Ğ¾ Ğ½Ğµ Ğ¿Ñ€Ğ¾Ğ´Ğ°Ñ‘Ñ‚ÑÑ

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** Events Ğ½Ğµ Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´ÑÑ‚ Ğ¾Ñ‚ WebSocket.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
1. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ `type: '*'` (Ğ½Ğµ `type: 'trade'`)
2. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ CLOB credentials Ğ² .env
3. ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ FUNDER address ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚ Ñ Ğ°Ğ´Ñ€ĞµÑĞ¾Ğ¼ Ğ½Ğ° Polymarket
4. Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ debug Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
   ```typescript
   log(`[DEBUG] Received message - topic: ${topic}, type: ${msgType}`);
   ```

#### WebSocket Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ÑÑ (code 1006)

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** ĞĞ½Ğ¾Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ñ.

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** Polymarket RTDS Ğ¿ĞµÑ€Ğ¸Ğ¾Ğ´Ğ¸Ñ‡ĞµÑĞºĞ¸ Ñ€Ğ°Ğ·Ñ€Ñ‹Ğ²Ğ°ĞµÑ‚ ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** RealTimeDataClient Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿ĞµÑ€ĞµĞ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ÑÑ. Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ¼ĞµĞ¶Ğ´Ñƒ Ñ€Ğ°Ğ·Ñ€Ñ‹Ğ²Ğ°Ğ¼Ğ¸ Ğ½Ğµ Ñ‚ĞµÑ€ÑÑÑ‚ÑÑ ĞµÑĞ»Ğ¸ reconnect Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹.

#### Market order Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** ĞĞµĞ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ°Ñ Ğ»Ğ¸ĞºĞ²Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚ÑŒ Ğ´Ğ»Ñ FOK.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ fallback Ğ½Ğ° FAK (Ñ‡Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ).

### Debug Ñ€ĞµĞ¶Ğ¸Ğ¼

**Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ verbose Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:**

Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ `DEBUG=1` Ğ² `.env` Ñ„Ğ°Ğ¹Ğ»Ğµ:
```bash
DEBUG=1
```

Ğ­Ñ‚Ğ¾ Ğ²ĞºĞ»ÑÑ‡Ğ¸Ñ‚ Ğ¿Ğ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ¾Ğµ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ²ÑĞµÑ… WebSocket ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹:
- Ğ’ÑĞµ Ğ²Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ Ñ topic Ğ¸ type
- API KEY Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞºĞµ Ğ½Ğ° User Channel
- Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚ trade events
- ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğµ ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚

**âš ï¸ Ğ’Ğ°Ğ¶Ğ½Ğ¾:** DEBUG Ñ€ĞµĞ¶Ğ¸Ğ¼ ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ Ğ²Ñ‹ÑĞ¾ĞºÑƒÑ CPU Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºÑƒ Ğ¿Ñ€Ğ¸ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¾Ğ¼ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ´Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ¸.

### Memory Ğ¸ CPU Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ (2025-12-26)

**Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ° ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ÑƒÑ‚ĞµÑ‡ĞºĞ° Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸:**

1. **processedTrades Map Ñ TTL** - Ğ¿Ñ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ±ĞµÑĞºĞ¾Ğ½ĞµÑ‡Ğ½Ñ‹Ğ¹ Ñ€Ğ¾ÑÑ‚ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸:
   - Ğ¡Ñ‚Ğ°Ñ€Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ: `Set<string>` - Ñ€Ğ¾Ñ Ğ±ĞµÑĞºĞ¾Ğ½ĞµÑ‡Ğ½Ğ¾ (Ñ‚Ñ‹ÑÑÑ‡Ğ¸ entries Ğ·Ğ° ÑÑƒÑ‚ĞºĞ¸)
   - ĞĞ¾Ğ²Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ: `Map<string, timestamp>` Ñ TTL 24 Ñ‡Ğ°ÑĞ°
   - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¾Ñ‡Ğ¸ÑÑ‚ĞºĞ° ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ‡Ğ°Ñ
   - Cleanup interval ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ Ğ¾ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ SIGINT

2. **DEBUG Ğ»Ğ¾Ğ³Ğ¸ ÑƒÑĞ»Ğ¾Ğ²Ğ½Ñ‹Ğµ** - ÑĞ½Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ CPU Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸:
   - Ğ¡Ñ‚Ğ°Ñ€Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ: Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ WebSocket ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ (10-100 msg/sec)
   - ĞĞ¾Ğ²Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ: DEBUG Ğ»Ğ¾Ğ³Ğ¸ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¿Ñ€Ğ¸ `DEBUG=1` Ğ² .env
   - Ğ­ĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ CPU Ğ¾Ñ‚ `toLocaleString()` Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ¾Ğ² Ğ½Ğ° ĞºĞ°Ğ¶Ğ´Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ

**Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ñƒ:**
```bash
# PM2 Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ğ¸ CPU
pm2 monit

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°Ğ·Ğ¼ĞµÑ€Ğ° processedTrades ĞºÑÑˆĞ°
# Ğ‘ÑƒĞ´ĞµÑ‚ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ Ğ¿Ñ€Ğ¸ cleanup: "Removed N old trades from cache (size: X)"
pm2 logs auto-sell-bot | grep CLEANUP
```

---

## Docker Deployment

### ĞĞ±Ğ·Ğ¾Ñ€

ĞŸÑ€Ğ¾ĞµĞºÑ‚ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ **one-click deployment** Ñ‡ĞµÑ€ĞµĞ· Docker Compose. Ğ’ÑĞµ Ğ±Ğ¾Ñ‚Ñ‹ Ğ¸ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ÑÑ‚ÑÑ Ğ² Ğ¸Ğ·Ğ¾Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°Ñ… Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ ÑĞ±Ğ¾Ñ€ĞºĞ¾Ğ¹ TypeScript Ğ¸ C++ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ².

### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Docker

```
Docker Compose
â”œâ”€â”€ trading-bot container (Node.js 18 + Python 3.9)
â”‚   â”œâ”€â”€ PM2 process manager
â”‚   â”‚   â”œâ”€â”€ updown-btc, updown-eth, updown-sol, updown-xrp
â”‚   â”‚   â”œâ”€â”€ updown-polling, updown-ws
â”‚   â”‚   â”œâ”€â”€ telegram-bot
â”‚   â”‚   â””â”€â”€ auto-sell-bot
â”‚   â”œâ”€â”€ TypeScript compiled to dist/
â”‚   â”œâ”€â”€ C++ binaries (optional, BUILD_CPP=true)
â”‚   â””â”€â”€ Logs â†’ ./logs/ (bind mount)
â”‚
â””â”€â”€ redemption-scheduler container (Python 3.9)
    â”œâ”€â”€ Runs every 60 minutes
    â”œâ”€â”€ Python venv (/opt/venv)
    â””â”€â”€ Logs â†’ ./logs/ (bind mount)
```

### Ğ¤Ğ°Ğ¹Ğ»Ñ‹ Docker ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸

```
Tuda_Suda_49/
â”œâ”€â”€ Dockerfile                      # Multi-stage build (cpp â†’ node â†’ final)
â”œâ”€â”€ docker-compose.yml              # ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
â”œâ”€â”€ docker-compose.override.yml     # Override Ğ´Ğ»Ñ Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ° Ğ±Ğ¾Ñ‚Ğ¾Ğ²
â”œâ”€â”€ docker-entrypoint.sh            # Entrypoint script (validation + PM2 start)
â”œâ”€â”€ docker-redemption-scheduler.sh  # Redemption loop script
â””â”€â”€ ecosystem.docker.config.js      # PM2 config Ğ´Ğ»Ñ Docker Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ
```

### Multi-Stage Dockerfile

**Stage 1: cpp-builder** (Ubuntu 24.04)
- ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ C++ latency Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ¸ trading Ğ±Ğ¸Ğ½Ğ°Ñ€Ğ½Ğ¸ĞºĞ¾Ğ²
- Ğ—Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸: build-essential, libcurl, libssl
- Output: `dist/updown-bot-cpp`, `dist/test-latency-cpp`

**Stage 2: node-builder** (Node 18 Alpine)
- npm install --production
- TypeScript compilation (tsc)
- Output: `dist/*.js`, `node_modules/`

**Stage 3: final** (Node 18 Debian Slim)
- ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ°Ñ€Ñ‚ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ğ² Ğ¸Ğ· stage 1 Ğ¸ 2
- Python 3.9 + venv (PEP 668 compliance)
- PM2 ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ğ¾
- Final image: ~800MB

### docker-compose.override.yml

**ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ:** ĞŸĞµÑ€ĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ·Ğ°Ğ¿ÑƒÑĞº Ğ±Ğ¾Ñ‚Ğ¾Ğ² Ğ´Ğ»Ñ Ñ€ÑƒÑ‡Ğ½Ğ¾Ğ³Ğ¾ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ.

```yaml
services:
  trading-bot:
    entrypoint: /bin/bash
    command: -c "tail -f /dev/null"
    healthcheck:
      test: ["CMD", "echo", "ok"]
      interval: 10s
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:**
- ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ Ğ‘Ğ•Ğ— Ğ°Ğ²Ñ‚Ğ¾ÑÑ‚Ğ°Ñ€Ñ‚Ğ° PM2 Ğ±Ğ¾Ñ‚Ğ¾Ğ²
- ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ·Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ² ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ğ½ÑƒĞ¶Ğ½Ñ‹Ñ… Ğ±Ğ¾Ñ‚Ğ¾Ğ² Ğ²Ñ€ÑƒÑ‡Ğ½ÑƒÑ
- Ğ“Ğ¸Ğ±ĞºĞ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ±ĞµĞ· Ğ¿ĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ¸ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²

### ecosystem.docker.config.js

**ĞÑ‚Ğ»Ğ¸Ñ‡Ğ¸Ñ Ğ¾Ñ‚ ecosystem.config.js (local VPS):**
- Paths: `/app` Ğ²Ğ¼ĞµÑÑ‚Ğ¾ `/root/Tuda_Suda_49`
- Interpreter: `./node_modules/.bin/ts-node` (Ğ°Ğ±ÑĞ¾Ğ»ÑÑ‚Ğ½Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ÑŒ)
- Logs: `/app/logs/` (Docker volume mount)

**ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ´Ğ»Ñ PM2 + ts-node:**
```javascript
{
  name: 'auto-sell-bot',
  script: 'src/auto-sell-bot.ts',          // ĞŸÑƒÑ‚ÑŒ Ğº Ñ„Ğ°Ğ¹Ğ»Ñƒ
  interpreter: './node_modules/.bin/ts-node',  // Ğ˜Ğ½Ñ‚ĞµÑ€Ğ¿Ñ€ĞµÑ‚Ğ°Ñ‚Ğ¾Ñ€
  args: '',                                 // ĞÑ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ (ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)
  cwd: '/app',
}
```

**âŒ ĞĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ (PM2 Ğ¾ÑˆĞ¸Ğ±ĞºĞ° "Script not found"):**
```javascript
{
  script: 'npx ts-node',  // âŒ PM2 Ğ¸Ñ‰ĞµÑ‚ Ñ„Ğ°Ğ¹Ğ» /app/npx
  args: 'src/auto-sell-bot.ts',
}
```

### Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

**Quick start:**
```bash
git clone https://github.com/Bezoutoff/Tuda_Suda_49.git
cd Tuda_Suda_49
cp .env.example .env
nano .env  # Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ credentials

docker compose up -d
```

**Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº Ğ±Ğ¾Ñ‚Ğ¾Ğ²:**
```bash
# Ğ—Ğ°Ğ¹Ñ‚Ğ¸ Ğ² ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€
docker exec -it tuda-suda-trading bash

# Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ğ½ÑƒĞ¶Ğ½Ğ¾Ğ³Ğ¾ Ğ±Ğ¾Ñ‚Ğ°
pm2 start ./node_modules/.bin/ts-node --name auto-sell-bot -- src/auto-sell-bot.ts

# Ğ˜Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· ecosystem.docker.config.js
pm2 start ecosystem.docker.config.js --only auto-sell-bot

# Ğ›Ğ¾Ğ³Ğ¸
pm2 logs auto-sell-bot

# Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ
pm2 list

# ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ
pm2 stop auto-sell-bot
```

**Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°Ğ¼Ğ¸:**
```bash
# Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ
docker compose ps

# Ğ›Ğ¾Ğ³Ğ¸
docker compose logs -f trading-bot

# ĞŸĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº
docker compose restart trading-bot

# ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°
docker compose down

# ĞŸĞµÑ€ĞµÑĞ±Ğ¾Ñ€ĞºĞ°
docker compose build --no-cache
docker compose up -d
```

### Build Arguments

**BUILD_CPP** - ĞºĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ C++ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²:
```yaml
# docker-compose.yml
services:
  trading-bot:
    build:
      args:
        BUILD_CPP: "true"  # ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ C++ (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ)
        # BUILD_CPP: "false"  # ĞŸÑ€Ğ¾Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ C++ (Ğ±Ñ‹ÑÑ‚Ñ€ĞµĞµ)
```

### Volume Mounts

```yaml
volumes:
  - ./logs:/app/logs        # Ğ›Ğ¾Ğ³Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹ Ğ½Ğ° Ñ…Ğ¾ÑÑ‚Ğµ
  - ./.env:/app/.env:ro     # Environment variables (read-only)
```

**Ğ›Ğ¾Ğ³Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑÑ‚ÑÑ Ğ½Ğ° Ñ…Ğ¾ÑÑ‚Ğµ:**
```bash
ls -lh logs/
tail -f logs/auto-sell-bot-out.log
tail -f logs/redemption.csv
```

### Health Checks

**trading-bot:**
```yaml
healthcheck:
  test: ["CMD", "echo", "ok"]  # Ğ£Ğ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ñ‹Ğ¹ (override)
  # test: ["CMD", "pm2", "ping"]  # ĞÑ€Ğ¸Ğ³Ğ¸Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ (Ğ·Ğ°ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½)
  interval: 10s
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ ÑƒĞ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ñ‹Ğ¹:**
- PM2 Ğ½Ğµ Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ (override)
- `echo ok` Ğ²ÑĞµĞ³Ğ´Ğ° Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ÑƒÑĞ¿ĞµÑ…
- ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ healthy Ğ´Ğ°Ğ¶Ğµ Ğ±ĞµĞ· Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½Ğ½Ñ‹Ñ… Ğ±Ğ¾Ñ‚Ğ¾Ğ²

### Troubleshooting Docker

#### Container is unhealthy / restarting

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** ĞšĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ¿Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ½Ğ¾ Ñ€ĞµÑÑ‚Ğ°Ñ€Ñ‚Ğ¸Ñ‚ÑÑ.

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** ĞÑˆĞ¸Ğ±ĞºĞ° Ğ² entrypoint Ğ¸Ğ»Ğ¸ PM2 ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```bash
# ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ»Ğ¾Ğ³Ğ¸
docker compose logs trading-bot --tail=100

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ docker-compose.override.yml ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚
cat docker-compose.override.yml

# ĞŸĞµÑ€ĞµÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹
docker compose down
docker compose up -d
```

#### PM2 Script not found: /app/ts-node

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:** ĞĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ² ecosystem.docker.config.js.

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** `script: 'npx ts-node'` Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ°.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**
```javascript
// âœ… ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾
{
  script: 'src/auto-sell-bot.ts',
  interpreter: './node_modules/.bin/ts-node',
}

// âŒ ĞĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾
{
  script: 'npx ts-node',
  args: 'src/auto-sell-bot.ts',
}
```

#### Version warning Ğ² docker-compose.yml

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ°:**
```
WARN: the attribute `version` is obsolete
```

**ĞŸÑ€Ğ¸Ñ‡Ğ¸Ğ½Ğ°:** Docker Compose v2 Ğ½Ğµ Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ version.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:** Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ° ÑÑ‚Ñ€Ğ¾ĞºĞ° `version: '3.8'` Ğ¸Ğ· docker-compose.yml.

### Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ°Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ Ğ² `README.docker.md`:
- Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Docker Ğ½Ğ° Ubuntu
- Quick Start Ğ·Ğ° 3 ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹
- ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ¸ build arguments
- ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ğ¸ Ğ»Ğ¾Ğ³Ğ¸
- Troubleshooting
- ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ systemd Ğ½Ğ° Docker

---

## Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ

- **2025-12-26**: Auto-Sell Bot - Memory/CPU Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸. Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ° ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ÑƒÑ‚ĞµÑ‡ĞºĞ° Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ (processedTrades Map Ñ TTL 24h), DEBUG Ğ»Ğ¾Ğ³Ğ¸ ÑƒÑĞ»Ğ¾Ğ²Ğ½Ñ‹Ğµ (env DEBUG=1), cleanup interval Ğ¿Ñ€Ğ¸ SIGINT
- **2025-12-24**: Fix auto-sell-bot PM2 error - Ğ°Ğ±ÑĞ¾Ğ»ÑÑ‚Ğ½Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ÑŒ ts-node interpreter Ğ² ecosystem.docker.config.js. Ğ ĞµÑˆĞµĞ½Ğ° Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° "Cannot use import statement outside a module"
- **2025-12-24**: ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ network intervals - STREAM_INTERVAL_MS: 5msâ†’20ms, POLL_INTERVAL_MS: 250msâ†’350ms. Ğ¡Ğ½Ğ¸Ğ¶ĞµĞ½Ğ¸Ğµ spam: 1600â†’400 req/sec, Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ñ‹ EPIPE/EAI_AGAIN Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
- **2025-12-24**: Fix updown-bot-49 ts-node error - Ğ°Ğ±ÑĞ¾Ğ»ÑÑ‚Ğ½Ñ‹Ğ¹ Ğ¿ÑƒÑ‚ÑŒ interpreter Ğ´Ğ»Ñ Docker PM2
- **2025-12-24**: updown-bot-49 - Ğ¼ÑƒĞ»ÑŒÑ‚Ğ¸Ğ²Ğ°Ğ»ÑÑ‚Ğ½Ñ‹Ğ¹ Ğ±Ğ¾Ñ‚ (BTC, ETH, SOL, XRP), Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Promise.all, manual mode, $19.60 capital per timestamp
- **2025-12-24**: updown-btc-49 Bot - ÑƒĞ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ğ°Ñ ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ñ (2 Ğ¾Ñ€Ğ´ĞµÑ€Ğ° Ğ¿Ğ¾ $0.49, 5 shares, manual mode only, expiration fixed)
- **2025-12-24**: Fix expiration logic - Ñ‚ĞµĞ¿ĞµÑ€ÑŒ Ğ¿Ğ¾ÑĞ»Ğµ ÑÑ‚Ğ°Ñ€Ñ‚Ğ° Ğ¼Ğ°Ñ€ĞºĞµÑ‚Ğ°, Ğ½Ğµ Ğ´Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚Ğ°
- **2025-12-18**: VPS Deployment Guide - Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸ Ğ´Ğ»Ñ Ubuntu 23.04+ (venv, PEP 668, systemd configuration)
- **2025-12-18**: Redemption Tracker - Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞº ÑƒĞ¶Ğµ Ğ²Ñ‹ĞºÑƒĞ¿Ğ»ĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹ (redeemed_tracker.py). Ğ­ĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ ~90% API Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ², 30-60 ÑĞµĞº Ğ½Ğ° Ğ·Ğ°Ğ¿ÑƒÑĞº
- **2025-12-15**: Redemption Bot debugging - Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ñ‹ API Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³, SDK Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ, calldata Ñ„Ğ¾Ñ€Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ. ĞÑÑ‚Ğ°Ğ»Ğ°ÑÑŒ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 401 Ğ°Ğ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ Ñ relayer.
- **2025-12-14**: Redemption Bot - Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ²Ñ‹ĞºÑƒĞ¿ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹ (Python, systemd timer, Telegram ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ)
- **2025-12-09**: Fix expirationBuffer - ÑƒÑ‡Ñ‘Ñ‚ +60 ÑĞµĞº Ğ¾Ñ‚ Polymarket
- **2025-12-08**: Python Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ latency (plot_latency.py), Ñ‚Ñ‘Ğ¼Ğ½Ğ°Ñ Ñ‚ĞµĞ¼Ğ°, Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğ¹
- **2025-12-08**: Fix latencyRecords tracking - shouldLog() Ñ‚ĞµĞ¿ĞµÑ€ÑŒ Ğ»Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµÑ‚ Ğ²ÑĞµ Ğ¿Ğ¾Ğ¿Ñ‹Ñ‚ĞºĞ¸
- **2025-12-08**: Fix C++ stdout buffering - Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ flush()
- **2025-12-08**: Fix expiration - Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ORDER_CONFIG.expirationBuffer
- **2025-12-05**: C++ latency test â€” Auth Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚! (fix: wallet addr, underscore headers, URL-safe base64)
- **2025-12-04**: Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ test-latency.ts Ğ´Ğ»Ñ Ğ¸Ğ·Ğ¼ĞµÑ€ĞµĞ½Ğ¸Ñ latency
- **2025-12-03**: 10 Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ² Ñ Ğ¸Ğ½Ğ´Ğ¸Ğ²Ğ¸Ğ´ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ expiration times
- **2025-11-25**: Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚, Ğ²Ñ‹Ğ´ĞµĞ»ĞµĞ½ Ğ¸Ğ· live-trade-PM
- Ğ ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹: https://github.com/Bezoutoff/Tuda_Suda_49
